---
title: "Homework 1 Solutions"
date: "Due XX/XX/2022 by 11:59pm EST"
output: html_document
---

Several of your friends live in Europe and are offered jobs at a US company with many locations all across the country. The job offers are great but news with headlines such as [**America is one of 6 countries that make up more than half of guns deaths worldwide**](https://www.vox.com/2018/8/29/17792776/us-gun-deaths-global) have them worried. Charts like this make them worry even more:

![US gun homicides chart](GunTrends_murders_per_1000.png) 

You want to convince your friends that the US is a large and diverse country with 50 very different states as well as the District of Columbia (DC). You want to recommend some states for each friend knowing that some like hiking, while others would like to be close to several large cosmopolitan cities. Use data from the [US murders data set](https://www.rdocumentation.org/packages/dslabs/versions/0.7.1/topics/murders):

```{r, message = FALSE, warning = FALSE}
library(tidyverse)
library(dslabs)
data(murders)
```


1. What is the state with the most murders? Would you say this is the 
most dangerous state? Hint: Make a plot showing the relationship between population size and number of murders.


```{r}
murders$state[which.max(murders$total)]
```

California is the state with the most murders. However, this does not necessarily make California the most dangerous state. The following plot shows that the number of murders is highly correlated with the population of any given state. California, the state with the highest population, also has the highest total number of murders.

```{r}
plot(murders$population, 
     murders$total,
     xlab = "Population", 
     ylab = "Murders",
     main = "Population and Gun Murders Across US States")
```


2. Add a column to the murder data table called `murder_rate` with each state's murder rate per 100,000 people.

**Solution:** 

```{r, warning=FALSE, message=FALSE}
murders <- murders %>% mutate(murder_rate = total / (population / 100000))

## Alternative approach
## murders$murder_rate <- murders$total / murders$population
```


3. Describe the distribution of murder rates across states. How similar are states? How much do murder rates vary by geographical regions?

The distribution is heavily right-skewed with a couple clear outliers, i.e. states with notably higher murder rates than the remaining 48. The South has a noticeably higher murder rate than other regions.

```{r}
## can use histogram
hist(murders$murder_rate, 
     breaks = 15,
     xlab = "Murders per 100,000", 
     ylab = "Number of States",
     main = "Murder Rates Across US States")

## can use boxplot by region
boxplot(murder_rate ~ region, 
        data = murders,
        xlab = "Region", 
        ylab = "Murders per 100,000",
        main = "Murder Rates by Region")
```


4. Which states have murder rates lower than 2 per 100,000 people? 

**Solution:** 

```{r}
murders$state[murders$murder_rate < 2]
```


5. Write a function called `states_below_cutoff` that takes two arguments: the `murders` dataset and a numeric `cutoff`. This function should return a vector of the states whose murder rates are below the `cutoff` argument. 

   As a sanity check to see if your function is behaving as expected, run `states_below_cutoff(murders, cutoff = 2)` and see if you get the same vector of states as in Question 4. Then, use your function to report the number of states that have murder rates below 3. 

**Solution:** 


Below, we define the `states_below_cutoff` function and check that running `states_below_cutoff(murders, cutoff = 2)` matches the results from Question 4. 

```{r}
states_below_cutoff <- function(murders, cutoff){
  return(murders$state[murders$murder_rate < cutoff])
}

states_below_cutoff(murders, cutoff = 2)
```

There are 32 states with murder rates below 3. 

```{r}
length(states_below_cutoff(murders, cutoff = 3))
```


6. Now, write a function called `states_below_cutoff_in_region`. Like `states_below_cutoff`, your new function should take the `murders` dataset and a numeric `cutoff` as arguments. However, `states_below_cutoff_in_region` should also take a third argument, `geo_region`, which is a character string indicating a geographical region (`"Northeast"`, `"South"`, `"North Central"`, or `"West"`) This function should return a vector of the states whose murder rates are below the `cutoff` argument AND are belong to the geographical region indicated by the `geo_region` argument. Hint: You may find it easier to first try writing some code to get the states with murder rates below a fixed cutoff (say, 2) and who belong to a certain geographical region (say, `"West"`). Once you have your specific example working, you can convert your code to the more general function. 

   Use your function to report the number of states from the `"West"` with murder rates below 2 and the number of states from the `"South"` with murder rates below 2. 

**Solution:** 

```{r}
states_below_cutoff_in_region <- function(murders, cutoff, geo_region){
  return(murders$state[murders$murder_rate < cutoff & 
                               murders$region == geo_region])
}
```

Eight western states have murder rates below 2. 

```{r}
length(states_below_cutoff_in_region(murders, cutoff = 2, geo_region = "West"))
```

Only one southern state has a murder rate below 2. 

```{r}
length(states_below_cutoff_in_region(murders, cutoff = 2, geo_region = "South"))
```


7. Write a report for your friends reminding them that the US is a large and diverse country with 50 very different states as well as the District of Columbia (DC). Suppose one of your friends loves hiking, one wants to live in a warm climate, and another would like to be close to several large cosmopolitan cities. Recommend a desirable state for each friend. Answers should be a minimum of 1 paragraph and a maximum of 3 paragraphs. One possible approach would be to look at the murder rates for each state, identify a reasonable maximum cutoff, and then pick the state(s) that best fit each friend's criteria from the states with murder rates below the cutoff. 

**Solution:** 

Full points for a reasonable writeup and supporting points and code. A complete response should include suggestions for each of the three friends based on both their interests (e.g. by considering states good for hiking) and the data analyzed in the previous three problems (e.g. by considering state-level murder rates).

These most often take the form of defining some rule (say, <1% murder rate below the mean murder rate or the mean within-region murder rate) and then using filter commands (or logicals as above) to produce a short list of possible locations. In some cases students simply hand-pick the states with little justification (e.g. NYC is a big city and has murder rate X). Failure to justify the answer with code like this should result in a maximum of -5. Failure to justify the answer with a reasonable writeup results in a maximum of -10. There will be a lot of variability overall but points should be removed for excessively short writeups or if there is no supporting evidence and code.


